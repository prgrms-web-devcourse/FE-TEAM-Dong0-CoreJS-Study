# Execution Context (ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸)

## What is execution context?

> ì‹¤í–‰í•  ì½”ë“œì— ì œê³µí•  í™˜ê²½ ì •ë³´ë“¤ì„ ëª¨ì•„ë†“ì€ ê°ì²´

### :book: In Core Javascript, Execution context is..

1. ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ë™ì  ì–¸ì–´ë¡œì„œì˜ ì„±ê²©ì„ ê°€ì¥ ì˜ íŒŒì•…í•  ìˆ˜ ìˆëŠ” ê°œë…
2. í´ë¡œì €ë¥¼ ì§€ì›í•˜ëŠ” ëŒ€ë¶€ë¶„ì˜ ì–¸ì–´ì—ì„œ ì´ì™€ ìœ ì‚¬í•˜ê±°ë‚˜ ë™ì¼í•œ ê°œë…ì´ ì¡´ì¬
3. í˜¸ì´ìŠ¤íŒ…, ì™¸ë¶€ í™˜ê²½ ì •ë³´ êµ¬ì„±, thisê°’ì˜ ì„¤ì • ë“± ëª¨ë‘ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ í™œì„±í™” ì‹œì ì— ë°œìƒ

## :thinking: Why execution context?

ì²«ë²ˆì§¸ ë¬¸ë‹¨ì„ ì½ìœ¼ë©´ì„œ ìƒê¸´ ê¶ê¸ˆì¦ì„ ì •ë¦¬í•´ ë´¤ë‹¤.

- ë™ì  ì–¸ì–´, ì •ì  ì–¸ì–´ë¥¼ ë‚˜ëˆ„ëŠ” ê¸°ì¤€ì— ëŒ€í•´ ëª…í™•í•˜ê²Œ ì„¤ëª… í•  ìˆ˜ ìˆëŠ”ê°€?
- ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ í•„ìš”í•œ ì´ìœ ê°€ ë­˜ê¹Œ?

### ì •ì  íƒ€ì… ì–¸ì–´ & ë™ì  íƒ€ì… ì–¸ì–´

> - ì •ì  íƒ€ì… ì–¸ì–´ - íƒ€ì…ì´ ì»´íŒŒì¼ ì‹œê°„ (Compile Time)ì— ê²°ì •ë˜ëŠ” ì–¸ì–´
> - ë™ì  íƒ€ì… ì–¸ì–´ - íƒ€ì…ì´ ì‹¤í–‰ ì‹œê°„ (Run Time)ì— ê²°ì •ë˜ëŠ” ì–¸ì–´

### ğŸ“• ìš©ì–´

- ì»´íŒŒì¼ (Compile) - ì¼ë°˜ì ìœ¼ë¡œ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì—ì„œ ê¸°ê³„ì–´ë¡œì˜ ë²ˆì—­ì„ ì˜ë¯¸í•œë‹¤
- ëŸ°íƒ€ì„ (Run time) - í”„ë¡œê·¸ë¨ì´ ë™ì‘í•˜ê³  ìˆëŠ” ì‹œê°„

## ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ëŠ” ì™œ í•„ìš”í•œê°€

### :thinking: Interpreter vs compile

ìë°”ìŠ¤í¬ë¦½íŠ¸ì™€ ê¸°ì¡´ì— ê³µë¶€í–ˆë˜ ì—¬ëŸ¬ ì •ì  ì–¸ì–´(C, C++ )ë“±ì—ì„œ ë³´ì´ëŠ” ì°¨ì´ëŠ” í˜„ì¬ í¬ê²Œ ë‘ê°€ì§€ë¡œ ë³´ì¸ë‹¤.

- ì •ì  íƒ€ì… / ë™ì  íƒ€ì…
- **compile / interpreter**
  > - ì¸í„°í”„ë¦¬í„° ì–¸ì–´ - ì†ŒìŠ¤ì½”ë“œë¥¼ í•œì¤„ í•œì¤„ ì½ì–´ê°€ë©° ëª…ë ¹ì„ ì²˜ë¦¬í•˜ëŠ” ì–¸ì–´
  > - ì»´íŒŒì¼ ì–¸ì–´ - ì†ŒìŠ¤ì½”ë“œë¥¼ í•œêº¼ë²ˆì— ë‹¤ë¥¸ ëª©ì  ì½”ë“œë¡œ ë²ˆì—­í•œ í›„, í•œë²ˆì— ì‹¤í–‰í•˜ëŠ” ì–¸ì–´

```javascript
function sum() {
	let res = 0
	for (let i = 1; i<= 10;i++) {
		res += i;
	}
	return res
}
//in JS
sum() // loop -> 55
sum() // loop -> 55
sum() // loop -> 55

//in compile language
sum() // = 55
sum() // = 55
sum() // = 55
}
```

ìë°” ìŠ¤í¬ë¦½íŠ¸ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ Interpreter ì–¸ì–´ë‹¤.

ìœ„ì˜ ì˜ˆì‹œ ì½”ë“œë¥¼ ë³´ë©´ JSì—ì„œëŠ” `sum()`ì„ ë§Œë‚ ë•Œ ë§ˆë‹¤ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•´ 55ë¥¼ ë°˜í™˜í•˜ë‹¤. ë°˜ë©´ ì»´íŒŒì¼ì„ ë§ˆì¹œ ê¸°ê³„ì–´ëŠ” sumì˜ ê²°ê³¼ë¥¼ 55ë¡œ ê¸°ì–µí•˜ê³  ìˆë‹¤.

ìœ„ì˜ ì˜ˆì‹œì½”ë“œëŠ” ì‚¬ì‹¤ í˜„ëŒ€ì˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì—ì„œëŠ” ì €ë ‡ê²Œ ë™ì‘í•˜ì§€ ì•Šì„ ê²ƒì´ë‹¤. ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ ë‚´ë¶€ì— Interpreterë¥¼ ê°ì‹œí•˜ê³  ìˆëŠ” Profilerì— ì˜í•´ ìµœì í™” í•  ìˆ˜ ìˆëŠ” ì½”ë“œ( ì£¼ë¡œ ë°˜ë³µë˜ëŠ” ë¸”ëŸ­ )ê°€ Compilerì— ì „ë‹¬ ë˜ê¸° ë•Œë¬¸ì´ë‹¤. ( JIT / Just in time compilation - í•„ìš”í•  ë•Œë§Œ ê·¸ë•Œ ê·¸ë•Œ )

> **ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ëŠ” ì‹¤í–‰ ê°€ëŠ¥í•œ ì½”ë“œê°€ ì‹¤í–‰ë˜ê¸° ìœ„í•´ í•„ìš”í•œ í™˜ê²½**
> -- <cite>Poiema web</cite>

### ê²°ë¡ 

ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” ì¸í„°í”„ë¦¬í„° ì–¸ì–´ì´ê¸° ë•Œë¬¸ì— í•œì¤„ í•œì¤„ì”© ê¸°ê³„ì–´ë¡œ ë²ˆì—­ ë˜ì–´ì•¼ í•˜ê³ , ë™ì  íƒ€ì… ì–¸ì–´ì´ê¸° ë•Œë¬¸ì— Run-time ì‹œì ì— íƒ€ì…ì´ ê²°ì •ëœë‹¤. ì´ëŸ° íŠ¹ì„±ìœ¼ë¡œ ì§ì‘í•´ ë´¤ì„ ë•Œ í•œì¤„ ì”© ë²ˆì—­ë˜ëŠ” ì‹œì  + íƒ€ì… ê²°ì • ë“± ì‹¤í–‰ ì‹œì ì— ê²°ì •ë˜ì–´ì•¼ í•˜ëŠ” ì—¬ëŸ¬ê°€ì§€ ì£¼ë³€ ì •ë³´ë“¤ì´ ìˆ˜ì§‘ë˜ëŠ” ì‘ì—…ì´ ì„ í–‰ë˜ì–´ì•¼ ë¬¸ì œ ì—†ì´ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆì—ˆì„ ê²ƒìœ¼ë¡œ ì˜ˆìƒëœë‹¤.

## ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ ìˆ˜ì§‘ ëŒ€ìƒ

- Variable Environment
  - environment record
  - outer environment reference
- Lexical Environment
  - environment record
  - outer environment reference
- ThisBinding

### Environment Record

í˜„ì¬ ì»¨í…ìŠ¤íŠ¸ì™€ ê´€ë ¨ëœ ì½”ë“œì˜ ì‹ë³„ì ì •ë³´ë“¤ì´ ì €ì¥ëœë‹¤.

#### Hoistingì˜ ì‹¤ì²´ ğŸ˜®

- ìŠ¤ì½”í”„ ìƒë‹¨ìœ¼ë¡œ ì„ ì–¸ ì½”ë“œê°€ ë¬¼ë¦¬ì ìœ¼ë¡œ ëŒê³  ì˜¬ë¼ì™€ ì§„ë‹¤ (X)
- ë„ëŒ€ì²´ ì¼ì–´ë‚˜ëŠ” ëª©ì ì´ ë­ì˜€ì„ê¹Œ? ê²°í•¨? ê·¸ëƒ¥ ì¼ì–´ë‚œë‹¤? (X)

> Execution Contextê°€ ì½”ë“œì˜ ì‹¤í–‰ì„ ìœ„í•´ ì •ë³´ë¥¼ ìˆ˜ì§‘í•  ë•Œ ì»¨í…ìŠ¤íŠ¸ ë‚´ë¶€ì˜ ë³€ìˆ˜ ì •ë³´ë¥¼ ì²˜ìŒë¶€í„° ëê¹Œì§€ í›‘ì–´ë‚˜ê°€ë©° ìˆ˜ì§‘í•œë‹¤. ì½”ë“œê°€ ì‹¤í–‰ë˜ê¸° ì´ì „ì— ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•œ ì •ë³´ë¥¼ ìœ ì§€í•˜ëŠ” ê²ƒì˜ ì¼í™˜ì´ë‹¤.

### Outer Environment Reference

ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ í™œì„±í™” ë˜ëŠ” ì‹œì ì˜ Lexical Environmentê°€ ì €ì¥ëœë‹¤.

```javascript
var a = 1 //------ (a)
var func = function () {
  console.log(a)
  var a = 3
}
outer() // ------ (b)
```

- (a) ì‹œì  - ì „ì—­ ì»¨í…ìŠ¤íŠ¸ í™œì„±í™”! ( ì „ì—­ environment Record = { a, func }, outer environment reference = x )
- (b) ì‹œì  - func ì»¨í…ìŠ¤íŠ¸ í™œì„±í™”!
  ( func environment Record = { a }, outer environment reference = [ GLOBAL, { a, func } ] )

## block scopeì˜ Execution Context

```javascript
for (var i = 0; i < 3; i++) {
  setTimeout(() => {
    console.log(i)
  }, 100)
}
// 3 3 3
for (let i = 0; i < 3; i++) {
  setTimeout(() => {
    console.log(i)
  }, 100)
}
// 0 1 2
```

í”íˆ ë³¼ìˆ˜ ìˆëŠ” ì˜ˆì œ. Block scopeì¸ letê³¼, Function scopeì¸ varì˜ ì°¨ì´ ë•Œë¬¸ì— ë°œìƒ í•œë‹¤ê³ ë§Œ ì•Œê³  ìˆì—ˆë‹¤. ì‹¤ì œ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ ì–´ë–»ê²Œ ìƒì„±ë˜ëŠ”ì§€ í™•ì¸í•´ ë³´ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.

varì˜ ê²½ìš°

```javascript
'global context' : {
	environmentRecord: {'i': 3},
	outerEnvironmentReference: [],
	this: winodw,
}
'setTimeout Context' : {
	outerEnvironmentReference: [Global, {'i': 3}]
} //Call stack ì—ì„œ pop
'setTimeout Context' : {
	outerEnvironmentReference: [Global, {'i': 3}]
} //Call stack ì—ì„œ pop
'setTimeout Context' : {
	outerEnvironmentReference: [Global, {'i': 3}]
}
```

letì˜ ê²½ìš°

```javascript
'global context': {
	environmentRecord: {},
	outerEnvironmentReference: [],
	this:winodw,
}
'for i=0 context' :{
	environmentRecord: {'i':0}
	outerEnvironmentReference: [Global, {}]
}
'for i=1 context' :{
	environmentRecord: {'i':1}
	outerEnvironmentReference: [Global, {}]
}
'for i=2 context' :{
	environmentRecord: {'i':2}
	outerEnvironmentReference: [Global, {}]
}
'setTimeout Context' : {
	outerEnvironmentReference: [for i=0 context, {'i':0}]
}
'setTimeout Context' : {
	outerEnvironmentReference: [for i=1 context, {'i':1}]
}
'setTimeout Context' : {
	outerEnvironmentReference: [for i=2 context, {'i':2}]
}
```
